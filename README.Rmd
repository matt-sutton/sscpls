---
output: github_document
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
```

Sparse Subspace Constrained Partial Least Squares 
=========================

`sscpls` is an R package that provides an implementation of an ADMM algorithm for sparse subspace constrained PLS.

### Install instructions
Use devtools to install:

```{r}
#library(devtools)
#install_github("sscpls", "matt-sutton")
```

#### Example 1 (Orthogonal components)

The PLS direction vectors are sparse using $\ell_1$ penalty term and must lie in a subspace which ensurse orthogonality of components. See below for an example.

```{r}
set.seed(0)
library(sscpls)
n<-50 # number of observations
p<-50 # number of variables
X<-matrix(rnorm(n*p),ncol=p)
X <- scale(X)
beta <- c(1:5, rep(0, p-5))
y<-X%*%beta + matrix(rnorm(n))

fitcv <- cv_sscpls(X, y, K = 1:4, lambda = 1:9/10, fold = 10)
fit <- sscpls(X, y, ncomp = fitcv$K, lambda = fitcv$lambda.1se, scale = F)

Beta_comps <- matrix(unlist(fit$Beta), ncol = 4) # Get Matrix of beta estimates at each component
show_nonzero(cbind(Beta_comps, beta))

M <- crossprod(X, y)
diag(crossprod(t(M)%*%fit$V)) # objective maximised
# round(crossprod(fit$x.scores),digits = 4)  # constraint satisfied
```

The objective and orthogonality constraints:
```{r}
M <- crossprod(X, y)
# objective maximised
diag(crossprod(t(M)%*%fit$V)) 
# constraint satisfied
round(crossprod(fit$x.scores),digits = 4)  
```

### Replication of simulation study

Replication of the simulation study of the subspace constrained PLS paper. The simulation uses the package simrel for generating data from a sparse subspace. 

See the subfolder replication. 

```{r fig.width=1, fig.height=10,echo=FALSE}
library(png)
library(grid)
img <- readPNG("replication/results/figure.png")
grid.raster(img)
```

